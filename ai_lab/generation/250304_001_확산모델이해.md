## 확산 확률 모델 (Diffusion Probabilistic Model, DPM)

### 확산이란?

확산은 물질(예: 이미지의 픽셀 값)이 시간이 지남에 따라 섞이고 퍼져나가 최종적으로 균일한 상태(예: 가우시안 노이즈)에 도달하는 현상을 말합니다.  이러한 확산 과정을 확률적으로 모델링하여 이미지 생성에 활용합니다.

### 마르코프 체인 (Markov Chain)

확산 과정을 모델링할 때 주로 마르코프 체인을 사용합니다. 마르코프 체인은 "미래 상태는 과거 상태와 독립적으로 현재 상태에만 의존한다"는 특징을 가집니다. 즉, 특정 시점의 상태는 바로 이전 시점의 상태에만 영향을 받습니다.

### DDPM (Denoising Diffusion Probabilistic Model)

DDPM은 이미지에 점진적으로 노이즈를 추가하는 확산 과정(forward diffusion process)과, 추가된 노이즈를 점진적으로 제거하여 이미지를 복원하는 역확산 과정(reverse diffusion process)을 학습합니다.

*   **Forward Diffusion:** 원본 이미지에 가우시안 노이즈를 점진적으로 추가하여 최종적으로 완전한 노이즈 이미지로 만듭니다. 이 과정은 마르코프 체인으로 정의됩니다.
*   **Reverse Diffusion:** 노이즈로부터 이미지를 복원하는 과정입니다. DDPM은 U-Net과 같은 신경망을 사용하여 각 단계에서 얼마나 노이즈를 제거해야 하는지를 학습합니다. 즉, 조건부 확률 분포  p(x\_t-1 | x\_t) 를 추정하는 것이 목표입니다.

DDPM 모델이 학습하는 것은 각 단계에서 추가된 노이즈를 얼마나 제거해야 하는지 (즉, 원본 이미지를 얼마나 복원해야 하는지)를 예측하는 것입니다.  이 때 U-Net 구조의 신경망이 주로 사용됩니다.

### 생성 모델의 3요소

*   높은 품질
*   빠른 속도
*   다양한 생성

### DDPM의 한계점

*   **계산 비용:** DDPM은 이미지를 생성하기 위해 여러 단계의 노이즈 제거 과정을 반복해야 하므로 계산 비용이 매우 높습니다. 특히 고해상도 이미지를 생성하는 데 많은 시간이 소요됩니다.
*   **생성 속도:** 반복적인 과정을 통해 이미지를 생성하므로 생성 속도가 느립니다. 실시간 애플리케이션에는 적합하지 않을 수 있습니다.
*   **메모리 요구량:** 학습 및 생성 과정에서 많은 메모리를 필요로 합니다.
*   **샘플링 효율성:** 고품질 이미지를 얻기 위해 많은 샘플링 단계가 필요하며, 이는 계산 비용 증가로 이어집니다.
*   **긴 꼬리 문제 (Long tail problem):** 학습 데이터에 희소하게 나타나는 객체나 스타일을 잘 생성하지 못하는 경향이 있습니다. 즉, 학습 데이터에 충분히 등장하지 않은 희귀한 데이터에 대해서는 생성 성능이 떨어질 수 있습니다.
*   **조건부 생성의 어려움:** 특정 조건(예: 텍스트 설명)에 따라 이미지를 생성하는 데 어려움이 있을 수 있습니다.  조건부 생성을 위해 추가적인 기법 (e.g., classifier-free guidance)이 필요합니다.

## DDIM (Denoising Diffusion Implicit Models)

DDIM은 DDPM의 단점을 개선하기 위해 개발된 모델입니다. DDPM의 느린 샘플링 속도를 개선하는 데 초점을 맞추었습니다.

*   **비-마르코프 (Non-Markovian) 확산 과정:** DDPM은 마르코프 체인을 사용하는 반면, DDIM은 비-마르코프 확산 과정을 사용하여 더 적은 단계로도 고품질 이미지를 생성할 수 있습니다.  즉, 각 단계가 이전 단계에만 의존하는 것이 아니라, 더 먼 과거의 상태에도 영향을 받을 수 있도록 합니다.
*   **결정론적 (Deterministic) 샘플링:** DDIM은 결정론적 방식으로 이미지를 생성하므로, DDPM에 비해 생성 속도가 빠릅니다.  DDPM은 확률적인 샘플링 과정을 거치지만, DDIM은 정해진 규칙에 따라 샘플링합니다.
*   **샘플링 속도 향상:** DDIM은 DDPM과 동일한 품질의 이미지를 더 적은 단계로 생성할 수 있어 샘플링 속도가 크게 향상되었습니다.
*   **조건부 생성 용이성:** DDIM은 특정 조건에 따라 이미지를 생성하는 데 더 유연합니다.

**요약:** DDIM은 DDPM의 단점(느린 속도, 높은 계산 비용)을 개선하고, 더 빠르고 효율적인 이미지 생성을 가능하게 합니다.  DDPM의 확률적 특성을 유지하면서도 샘플링 속도를 크게 향상시킨 모델입니다.

## 기타 Diffusion Model 관련 연구

*   **Denoising Diffusion GANs (DDGAN):** Diffusion 모델과 GAN을 결합하여 빠르고 고품질의 이미지 생성을 목표로 합니다.
*   **Progressive Distillation:**  더 적은 단계로 Diffusion Model을 근사하는 방법입니다.
*   **Consistency Model:**  빠른 샘플링 속도를 위해 설계된 모델입니다.
*   **Latent Consistency Model:**  잠재 공간에서 Consistency Model을 적용하여 효율성을 높입니다.
*   **조건부 DPM:**  텍스트, 이미지 등 특정 조건에 맞는 이미지를 생성하는 DPM입니다.
*   **Guided Diffusion:**  Classifier나 다른 guidance를 활용하여 생성 과정을 제어합니다.
*   **Classifier-free Diffusion Guidance:**  Classifier 없이 guidance를 적용하는 방법입니다.
